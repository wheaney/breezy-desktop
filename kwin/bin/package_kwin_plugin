#!/usr/bin/env bash

# exit when any command fails
set -e

ARCH=${ARCH:-$(uname -m)}
if [ -n "${STEAMOS+x}" ]; then
    ARCH="steamos"
fi
echo "Building Breezy KWin plugin for $ARCH"

BUILD_PATH=build
rm -rf $BUILD_PATH
mkdir $BUILD_PATH

pushd $BUILD_PATH
cmake ..
make
cpack -G TGZ
popd

mkdir -p out
cp $BUILD_PATH/breezy_desktop.tar.gz out/breezyKWinPlugin-$ARCH.tar.gz